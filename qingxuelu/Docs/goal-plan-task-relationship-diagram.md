# 目标、计划、任务关系图

## 📊 数据关系图

```
┌─────────────────┐
│   学习目标      │
│  (LearningGoal) │
└─────────┬───────┘
          │ 1:N
          ▼
┌─────────────────┐
│   学习计划      │
│  (LearningPlan) │
└─────────┬───────┘
          │ 1:N
          ▼
┌─────────────────┐
│   周计划        │
│  (WeeklyPlan)   │
└─────────┬───────┘
          │ 1:N
          ▼
┌─────────────────┐
│   学习任务      │
│  (LearningTask) │
└─────────┬───────┘
          │ 1:N
          ▼
┌─────────────────┐
│   学习记录      │
│  (LearningRecord)│
└─────────────────┘
```

## 🔗 关联关系图

```
                    ┌─────────────┐
                    │   目标页面   │
                    │  (GoalsView)│
                    └─────┬───────┘
                          │
                          ▼
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   学习目标      │◄───┤   学习计划      │◄───┤   学习任务      │
│  (LearningGoal) │    │  (LearningPlan) │    │  (LearningTask) │
└─────────────────┘    └─────────────────┘    └─────────────────┘
         ▲                       ▲                       ▲
         │                       │                       │
         │ 1:N                   │ 1:N                   │ 1:N
         │                       │                       │
         ▼                       ▼                       ▼
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   计划页面      │    │   今日页面      │    │   任务页面      │
│  (PlanView)     │    │  (TodayView)   │    │  (TasksView)    │
└─────────────────┘    └─────────────────┘    └─────────────────┘
```

## 📱 页面操作流程图

### 目标页面操作
```
目标页面
    │
    ├── 创建目标
    │   └── 填写目标信息
    │
    ├── 生成计划
    │   ├── 选择目标模板
    │   ├── AI生成计划
    │   └── 计划关联到目标
    │
    └── 添加任务
        ├── 创建任务
        └── 任务关联到目标
```

### 计划页面操作
```
计划页面
    │
    ├── 查看计划详情
    │   └── 显示关联目标
    │
    ├── 管理周计划
    │   ├── 查看周计划
    │   └── 调整时间安排
    │
    └── 管理任务
        ├── 查看计划生成的任务
        ├── 添加补充任务
        └── 任务关联到计划
```

### 今日页面操作
```
今日页面
    │
    ├── 查看今日任务
    │   └── 时间线显示
    │
    ├── 添加任务
    │   ├── 创建新任务
    │   ├── 选择关联目标（可选）
    │   └── 选择关联计划（可选）
    │
    └── 编辑任务
        ├── 修改任务信息
        ├── 关联/取消关联目标
        └── 关联/取消关联计划
```

### 任务页面操作
```
任务页面
    │
    ├── 查看所有任务
    │   ├── 按状态筛选
    │   ├── 按关联关系筛选
    │   └── 显示关联信息
    │
    ├── 编辑任务
    │   ├── 修改任务信息
    │   ├── 关联/取消关联目标
    │   └── 关联/取消关联计划
    │
    └── 批量操作
        ├── 选择多个任务
        ├── 批量关联到目标
        └── 批量关联到计划
```

## 🔄 数据流转图

### 目标驱动流程
```
用户创建目标
    │
    ▼
AI分析目标
    │
    ▼
生成学习计划
    │
    ▼
分解为周计划
    │
    ▼
生成具体任务
    │
    ▼
任务显示在时间线
```

### 手动任务流程
```
用户点击添加任务
    │
    ▼
填写任务信息
    │
    ├── 选择关联目标（可选）
    │   └── 任务类型：goalRelated
    │
    ├── 选择关联计划（可选）
    │   └── 任务类型：planGenerated
    │
    └── 不关联任何对象
        └── 任务类型：manual
    │
    ▼
保存任务
```

### 重复任务流程
```
用户创建重复任务
    │
    ▼
设置重复模式
    │
    ├── 每日重复
    ├── 每周重复
    ├── 每月重复
    └── 自定义重复
    │
    ▼
系统自动生成重复实例
    │
    ▼
重复任务显示在时间线
```

## 📊 关联状态图

```
任务状态
    │
    ├── 独立任务
    │   └── taskType: manual
    │       └── goalId: nil, planId: nil
    │
    ├── 目标相关任务
    │   └── taskType: goalRelated
    │       └── goalId: 有值, planId: nil
    │
    ├── 计划生成任务
    │   └── taskType: planGenerated
    │       └── goalId: 有值, planId: 有值
    │
    └── 重复任务
        └── taskType: recurring
            └── isRecurring: true
```

## 🎯 页面关联矩阵

| 页面 | 目标 | 计划 | 任务 | 操作类型 |
|------|------|------|------|----------|
| 目标页面 | ✅ 创建/编辑 | ✅ 生成计划 | ✅ 添加任务 | 目标 → 计划/任务 |
| 计划页面 | ✅ 查看关联 | ✅ 创建/编辑 | ✅ 管理任务 | 计划 → 任务 |
| 今日页面 | ✅ 关联任务 | ✅ 关联任务 | ✅ 创建/编辑 | 任务 ↔ 目标/计划 |
| 任务页面 | ✅ 关联任务 | ✅ 关联任务 | ✅ 管理所有 | 任务 ↔ 目标/计划 |

## 📝 关联操作总结

### 可进行的关联操作
1. **目标 → 计划**: 在目标页面生成学习计划
2. **目标 → 任务**: 在目标页面添加相关任务
3. **计划 → 任务**: 在计划页面管理计划任务
4. **任务 → 目标**: 在任务页面关联任务到目标
5. **任务 → 计划**: 在任务页面关联任务到计划

### 关联规则
- 一个目标可以有多个计划
- 一个计划可以有多个任务
- 一个任务可以关联到目标（可选）
- 一个任务可以关联到计划（可选）
- 任务可以独立存在（不关联任何对象）

### 关联显示
- 在任务卡片上显示关联的目标/计划信息
- 在目标页面显示关联的计划和任务
- 在计划页面显示关联的目标和任务
- 支持按关联关系筛选和搜索
